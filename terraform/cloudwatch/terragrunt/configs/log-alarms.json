{
  "error-log-pattern": {
    "log_group_name": "/aws/lambda/api-function",
    "pattern": "[timestamp, level=ERROR, message]",
    "transformation_name": "ErrorCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Error log pattern detected in API function logs",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 1,
    "period": 300,
    "statistic": "Sum",
    "threshold": 0,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev1",
    "sub_service": "Errors",
    "error_details": "error-log-pattern-detected",
    "customer": "enbd-preprod",
    "team": "DNA",
    "alarm_actions": ["arn:aws:sns:us-east-1:123456789012:alerts-topic"]
  },
  "high-latency-pattern": {
    "log_group_name": "/aws/lambda/api-function",
    "pattern": "[timestamp, level=INFO, message=*latency*, duration=*]",
    "transformation_name": "HighLatencyCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "High latency requests detected in API function logs",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 2,
    "period": 300,
    "statistic": "Sum",
    "threshold": 5,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev2",
    "sub_service": "Performance",
    "error_details": "high-latency-requests-detected",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "authentication-failures": {
    "log_group_name": "/aws/applicationloadbalancer/access-logs",
    "pattern": "[timestamp, client_ip, target_ip, request_processing_time, target_processing_time, response_processing_time, elb_status_code, target_status_code, received_bytes, sent_bytes, request, user_agent, ssl_cipher, ssl_protocol, target_group_arn, trace_id, domain_name, chosen_cert_arn, matched_rule_priority, request_creation_time, actions_executed, redirect_url, lambda_error_reason, target_port_list, target_status_code_list, classification, classification_reason]",
    "transformation_name": "AuthFailureCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Authentication failures detected in ALB access logs",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 1,
    "period": 300,
    "statistic": "Sum",
    "threshold": 10,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev1",
    "sub_service": "Security",
    "error_details": "authentication-failures-detected",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "database-connection-errors": {
    "log_group_name": "/aws/rds/instance/main-database/error",
    "pattern": "[timestamp, level=ERROR, message=*connection*]",
    "transformation_name": "DBConnectionErrorCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Database connection errors detected",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 1,
    "period": 300,
    "statistic": "Sum",
    "threshold": 0,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev1",
    "sub_service": "Database",
    "error_details": "database-connection-errors",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "lambda-timeout-errors": {
    "log_group_name": "/aws/lambda/batch-processor",
    "pattern": "[timestamp, level=ERROR, message=*Task timed out*]",
    "transformation_name": "LambdaTimeoutCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Lambda function timeout errors detected",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 1,
    "period": 300,
    "statistic": "Sum",
    "threshold": 0,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev1",
    "sub_service": "Lambda",
    "error_details": "lambda-timeout-errors",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "api-5xx-errors": {
    "log_group_name": "/aws/applicationloadbalancer/access-logs",
    "pattern": "[timestamp, client_ip, target_ip, request_processing_time, target_processing_time, response_processing_time, elb_status_code, target_status_code, received_bytes, sent_bytes, request, user_agent, ssl_cipher, ssl_protocol, target_group_arn, trace_id, domain_name, chosen_cert_arn, matched_rule_priority, request_creation_time, actions_executed, redirect_url, lambda_error_reason, target_port_list, target_status_code_list, classification, classification_reason]",
    "transformation_name": "API5xxErrorCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "API 5xx errors detected in ALB access logs",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 1,
    "period": 300,
    "statistic": "Sum",
    "threshold": 5,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev1",
    "sub_service": "API",
    "error_details": "api-5xx-errors-detected",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "slow-database-queries": {
    "log_group_name": "/aws/rds/instance/main-database/slowquery",
    "pattern": "[timestamp, query_time, lock_time, rows_sent, rows_examined, sql_text]",
    "transformation_name": "SlowQueryCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Slow database queries detected",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 2,
    "period": 300,
    "statistic": "Sum",
    "threshold": 3,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev2",
    "sub_service": "Database",
    "error_details": "slow-database-queries",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "memory-leak-pattern": {
    "log_group_name": "/aws/lambda/memory-intensive-function",
    "pattern": "[timestamp, level=WARN, message=*memory usage*, usage=*]",
    "transformation_name": "MemoryLeakCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Memory leak pattern detected in Lambda function",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 3,
    "period": 300,
    "statistic": "Sum",
    "threshold": 2,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev2",
    "sub_service": "Lambda",
    "error_details": "memory-leak-pattern-detected",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "security-scan-failures": {
    "log_group_name": "/aws/lambda/security-scanner",
    "pattern": "[timestamp, level=ERROR, message=*security scan failed*, vulnerability=*]",
    "transformation_name": "SecurityScanFailureCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Security scan failures detected",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 1,
    "period": 300,
    "statistic": "Sum",
    "threshold": 0,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev1",
    "sub_service": "Security",
    "error_details": "security-scan-failures",
    "customer": "enbd-preprod",
    "team": "DNA"
  },
  "payment-processing-errors": {
    "log_group_name": "/aws/lambda/payment-processor",
    "pattern": "[timestamp, level=ERROR, message=*payment processing failed*, transaction_id=*]",
    "transformation_name": "PaymentErrorCount",
    "transformation_namespace": "CustomMetrics",
    "transformation_value": "1",
    "default_value": "0",
    "alarm_description": "Payment processing errors detected",
    "comparison_operator": "GreaterThanThreshold",
    "evaluation_periods": 1,
    "period": 300,
    "statistic": "Sum",
    "threshold": 0,
    "treat_missing_data": "notBreaching",
    "unit": "Count",
    "severity": "Sev1",
    "sub_service": "Payments",
    "error_details": "payment-processing-errors",
    "customer": "enbd-preprod",
    "team": "DNA"
  }
}
